네, 그러면 이제 그림이 딱 맞아 떨어집니다 👍

지금 올려주신 이 **헤더 파일**의 정의와 설명을 실제 하드웨어 구조(  
**메인보드 + 파워서플라이 + 캐리어가스 1세트**

- **솔레노이드 보드 2장 × 각 보드 6포트 = 총 12포트**) 에 대입하면 이렇게 해석됩니다.
    

---

## 1. 하드웨어와 레지스터 주소 매핑

## 기본 장치

- **MFC_MID** : 메인보드 장치 ID (`0x01`)
    
- **MFC_CMD**, **MFC_RPW**, **MFC_CPW** … : 펌프, 클린 동작, 전력, 시간, PWM 주파수 등 **전체 시스템 동작** 제어용
    

## 보드・포트 관련

- **MFC_NSB** (`0x0FBD`)  
    → 솔레노이드 보드 개수 읽기  
    (여기서는 2 보드가 응답으로 옴)
    
- **MFC_SPS** (`0x0FDC`)  
    → 전체 포트 상태값 (각 보드 6포트 × 보드 수 → 12포트 상태)
    
- **MFC_SPA** (`0x1086`)  
    → 포트 Duty(출력 비율) 설정 시작 주소
    
    - 보드 0: `0x1086` ~ `0x1086+5` (포트 1~6)
        
    - 보드 1: `0x108E` ~ `0x108E+5` (포트 7~12)  
        ‣ 계산식: `MFC_SPA + (sol_board_number * 8) + ((port_number-1) % 6)`
        

---

## 2. "12개 제어"가 어떻게 이루어지는지

소프트웨어(C 코드) 입장에서 보면

text

`[보드 수 읽기]  MFC_NSB  -> 2 보드 [포트 상태 읽기] MFC_SPS -> 각 포트별 상태 (ready/run/clean/에러) [포트 제어]     MFC_SPA 시작주소 + 오프셋에 Duty 값 쓰기`

- **각 보드 당** 6개의 레지스터(연속 주소)에 Duty 값을 씁니다.
    
- 이 Duty 값(0~10000 = 0~100.00%)이 개별 밸브/펌프의 개방률이 됩니다.
    
- 2개의 보드라면 첫 번째 Write는 보드 0, 두 번째 Write는 보드 1에 해당.
    

---

## 3. 관련 제어 함수

- `SetDutyBoard_MFC(int sbdindex)`  
    → `sbdindex = 0` → 포트 1~6,  
    `sbdindex = 1` → 포트 7~12에 Duty 값 전송  
    → 내부에서 `MFC_SPA + (sbdindex*8)` 주소로 시작해서 6포트 값을 패킷에 담아 `SendToCom()`으로 펌웨어 전송  
    → 펌웨어는 해당 보드의 포트를 실제 구동
    
- `ReadDutyBoard_MFC(int sbdindex)`  
    → 각 보드의 현재 Duty 값 읽어오기
    

---

## 4. 요약 도식

**하드웨어 구성 → 레지스터 구조 연결**

text

`메인보드(ID=0x01, 펌프/시스템 제어)    │   ├─ 솔레노이드 보드 #0 (포트1~6)   │    - Duty 주소: 0x1086 ~ 0x108B   │   └─ 솔레노이드 보드 #1 (포트7~12)        - Duty 주소: 0x108E ~ 0x1093`

**소프트웨어는 MFC_SPA 주소를 기준으로 보드 번호 × 8 + 포트 인덱스 방식으로 접근**

---

✅ 결론  
지금 헤더파일에는 **12개의 밸브/펌프 제어를 위한 모든 기본 레지스터 주소 규칙**이 포함돼 있고,  
실제 제어는 `SetDutyBoard_MFC()` 같은 함수에서 보드별 Duty 값을 계산하여 이들 주소로 쓰는 방식으로 이뤄집니다.  
즉, 레지스터 맵 설계 자체가 6포트 단위 보드에 맞춰져 있어서, 2보드면 자연스럽게 12채널 제어 구조가 됩니다.

---

원하시면 제가 **"PC 제어 코드 ↔ 레지스터 주소 ↔ 실제 밸브"**의 매핑을 한눈에 보는 표로 만들어 드릴 수 있습니다.  
그러면 “포트1 ~ 포트12”가 각각 어떤 주소에 대응되는지 바로 볼 수 있습니다.  
그 표 만들어 드릴까요?

1. [https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/72041696/dc3b4d43-737f-481b-92a3-7b3d9ed8480e/ControlPumpMFC.c](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/72041696/dc3b4d43-737f-481b-92a3-7b3d9ed8480e/ControlPumpMFC.c)