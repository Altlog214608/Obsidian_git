AI ì¶”ì²œ ê²°ê³¼ í¸í–¥ 

# FrSmart.py

def setUiFindExpDlg(self, number):
    # ë°°ê²½ ì´ë¯¸ì§€ ì„¤ì • (ê·¸ëŒ€ë¡œ)
    self.ui_find_exp_dlg.label_background.setStyleSheet(
        dsImage.dsFindDetailImg[number])

    # âœ… URL íŒŒë¼ë¯¸í„° êµ¬ì„±
    try:
        # MBTI ë¬¸ìì—´ë¡œ ë³€í™˜(ì„ íƒ personality â†’ MBTI)
        mbti_str = self._convert_personality_to_mbti(getattr(self, 'find_per_range_num', 0))

        # ì„ íƒê°’ ìˆ˜ì§‘: (ì—†ìœ¼ë©´ 0ìœ¼ë¡œ)
        def nz(x): 
            return int(x) if isinstance(x, (int, float)) else int(x) if str(x).isdigit() else 0

        params = {
    "perfume": number,
    "gender_id": nz(getattr(self, 'find_gender_range_num', 0)),
    "age_id": nz(getattr(self, 'find_age_range_num', 0)),
    "mbti": mbti_str if mbti_str != 'NONE' else "",
    "fashion_id": nz(getattr(self, 'find_fashion_range_num', 0)),
    "pref_color_id": nz(getattr(self, 'find_color_range_num', 0)),
    "purpose_id": nz(getattr(self, 'find_purpose_range_num', 0)),

    # ğŸ”§ ì—¬ê¸°! Scent(=ì¹´í…Œê³ ë¦¬) ì„ íƒê°’ì„ ì‹¤ì œë¡œ ì“°ê¸°
    # ê¸°ì¡´: "category_id": nz(getattr(self, 'find_category_range_num', 0)),
    "category_id": nz(getattr(self, 'find_scent_range_num', getattr(self, 'find_category_range_num', 0))),

    "top": 30, "middle": 40, "base": 30,
    "lang": "en",
}

        # âœ… QR ìƒì„± (ëª¨ë°”ì¼ ê²°ê³¼ URLë¡œ ê³ ì •)
        qr_path = dsQRcode.generate_qr_code(
            save_path=f"temp_qr_{number}.png",
            base_url="https://perfume-mobile.vercel.app/result",
            params=params,
        )

        # QR ë¼ë²¨ ë°°ì¹˜ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€)
        if not hasattr(self, 'qr_label'):
            self.qr_label = QtWidgets.QLabel(self.ui_find_exp_dlg)
            self.qr_label.setFixedSize(100, 100)
            self.qr_label.setStyleSheet("border: none; background: transparent;")

        qr_pixmap = QtGui.QPixmap(qr_path)
        self.qr_label.setPixmap(qr_pixmap.scaled(100, 100, Qt.AspectRatioMode.KeepAspectRatio))
        self.qr_label.move(self.ui_find_exp_dlg.width() - 120, 20)
        self.qr_label.show()

    except Exception as e:
        print(f"QR ì½”ë“œ ìƒì„± ì˜¤ë¥˜: {e}")
        if hasattr(self, 'qr_label'):
            self.qr_label.hide()


---

# dsQRcode.py

import qrcode
import random
from urllib.parse import urlencode

# ê¸°ì¡´ ì „ì—­ base_urlì€ ë³´ê´€(ë ˆê±°ì‹œ)
LEGACY_BASE_URL = "https://hashswim.github.io/perfume_mobile_page/"

# âœ… ìƒˆ ê¸°ë³¸ URL (ëª¨ë°”ì¼ ê²°ê³¼ í˜ì´ì§€)
DEFAULT_RESULT_URL = "https://perfume-mobile.vercel.app/result"

def generate_qr_code(idx=None, save_path=None, *, base_url=DEFAULT_RESULT_URL, params=None):
    """
    paramsê°€ ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ì¿¼ë¦¬ë¡œ ì¸ì½”ë”©í•˜ì—¬ QR ìƒì„±.
    paramsê°€ ì—†ìœ¼ë©´ (ë ˆê±°ì‹œ) idx ê¸°ë°˜ URL ì‚¬ìš©.
    """
    if params and isinstance(params, dict):
        # ë¹ˆ ê°’ì€ ì œê±°
        cleaned = {k: v for k, v in params.items() if v not in (None, "", -1)}
        full_url = f"{base_url}?{urlencode(cleaned)}"
    else:
        # ë ˆê±°ì‹œ ë™ì‘ ìœ ì§€: idx ì‚¬ìš©
        if idx is None:
            idx = random.randint(0, 11)
        full_url = f"{LEGACY_BASE_URL}?{urlencode({'idx': idx})}"

    # QR ìƒì„±
    qr = qrcode.QRCode(
        version=1,
        error_correction=qrcode.constants.ERROR_CORRECT_L,
        box_size=10,
        border=4,
    )
    qr.add_data(full_url)
    qr.make(fit=True)
    img = qr.make_image(fill_color="black", back_color="white")

    if save_path is None:
        # íŒŒì¼ëª…: perfume_qr_<timestamp or perfume>.png ë“±, í•„ìš”ì‹œ ë³€ê²½
        save_path = "qrcode.png"

    img.save(save_path)
    print(f"[QR] {full_url} -> saved: {save_path}")
    return save_path



---

ë§ì•„ìš”â€”**2ë²ˆ(ìƒ‰ìƒ í…ìŠ¤íŠ¸ í•¨ìˆ˜ êµì²´)**ëŠ” ì—¬ê¸°ì˜ˆìš”.

- íŒŒì¼: `FrSmart.py`
    
- ìœ„ì¹˜: `find_recommend(...)` ì•ˆì—ì„œ `deepfm_input_data` ë§Œë“œëŠ” ë¶€ë¶„  
    ì§€ê¸ˆì€ ì´ë ‡ê²Œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤ (ìƒ‰ìƒì´ 1~7 ì „ìš© ë§µì„ ì¨ì„œ 8 ê°™ì€ ê°’ì´ ë“¤ì–´ì˜¤ë©´ `None`ì´ ë‚˜ì™€ìš”):  
    `'Preferred_Color': self._convert_color_to_text(color),`
    

### ê³ ì¹˜ëŠ” í•œ ì¤„

`# before 'Preferred_Color': self._convert_color_to_text(color), 
# after 'Preferred_Color': self._convert_pref_to_text(color),`