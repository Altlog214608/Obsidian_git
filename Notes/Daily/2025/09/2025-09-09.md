def saveReportIdentification(self, save_file):


        workbook = xlsxwriter.Workbook(save_file)
        worksheet_main = workbook.add_worksheet(dsText.reportText["report_sheet"])
        worksheet_main.set_column("A:M", 5.4)  # 기본 셀 너비 (필요시 확대)

        # ---------- 셀 포맷 ----------
        format_title = workbook.add_format(
            {"bold": True, "font_size": 16, "align": "center", "valign": "vcenter"}
        )
        format_small_title = workbook.add_format(
            {"bold": True, "font_size": 11, "align": "left", "valign": "vcenter"}
        )
        format_small_table_title = workbook.add_format(
            {
                "bold": True,
                "font_size": 11,
                "border": 1,
                "align": "center",
                "valign": "vcenter",
            }
        )
        format_score = workbook.add_format(
            {"bold": True, "font_size": 11, "align": "right", "valign": "vcenter"}
        )
        format_score_base = workbook.add_format(
            {"bold": True, "font_size": 11, "align": "left", "valign": "vcenter"}
        )
        format_table = workbook.add_format(
            {
                "font_size": 9,
                "border": 1,
                "align": "center",
                "valign": "vcenter",
                "shrink": True,
            }
        )

        # ---------- 메인 시트 일반 정보 ----------
        worksheet_main.write("G1", dsText.reportText["report_title"], format_title)
        worksheet_main.write("A7", dsText.reportText["report_name"], format_small_title)
        worksheet_main.write("C7", self.record_name)
        worksheet_main.write(
            "A8", dsText.reportText["report_birth_date"], format_small_title
        )
        worksheet_main.write("C8", self.record_birth_date)
        worksheet_main.write("A9", dsText.reportText["report_gender"], format_small_title)
        worksheet_main.write("C9", self.record_gender)
        worksheet_main.write("A10", dsText.reportText["report_date"], format_small_title)
        worksheet_main.write("C10", self.record_test_date_time)

        worksheet_main.merge_range(
            "G3:I3", dsText.reportText["report_ammonia"], format_small_table_title
        )
        worksheet_main.merge_range("G4:I5", "", format_small_table_title)  # 빈칸
        worksheet_main.merge_range(
            "J3:K3", dsText.reportText["report_total_score"], format_small_table_title
        )
        worksheet_main.merge_range(
            "L3:M3", dsText.reportText["report_nomosmia"], format_small_table_title
        )
        worksheet_main.merge_range(
            "L4:M4", dsText.reportText["report_hyposmia"], format_small_table_title
        )
        worksheet_main.merge_range(
            "L5:M5", dsText.reportText["report_anosmia"], format_small_table_title
        )

        # ---------- 점수 정보 영역 ----------
        worksheet_main.write(
            "A30", dsText.resultText["result_test_identification_title"], format_small_title
        )
        worksheet_main.write(
            "K30", dsText.resultText["result_test_identification_point"] + ":", format_score
        )
        worksheet_main.write(
            "L35",
            dsText.resultText["result_test_identification_correct"],
            format_score_base,
        )
        worksheet_main.write(
            "L36",
            dsText.resultText["result_test_identification_incorrect"],
            format_score_base,
        )

        # ---------- 인지 결과 테이블 (가로 방향) ----------
        # record_id_results: (index, answer, choice_response, is_choice_correct, str_response, is_str_correct) 리스트
        if len(self.record_id_results) > 1:
            # 실제 출제된 문항 수(가로 칸 개수) - 헤더 행이 없다면 그대로 길이, 헤더가 있다면 -1로 조정
            # 현재 구조상 record_id_results는 데이터 행들로 구성되어 있다고 가정
            total_q = len(self.record_id_results)

            # 가로 테이블을 B열부터 채우자(=엑셀 B 컬럼). O/X는 34행에 위치(0-index row 33).
            col_start = 1  # B
            row_idx_num = 30  # "문항" 행 (0-index, 엑셀 31행). 원래 코드 유지
            row_idx_ans = 31  # "정답" 행
            row_idx_sel = 32  # "선택" 행
            row_idx_ox = 33  # "O/X" 행
            ox_row_excel = row_idx_ox + 1  # 엑셀 표기(1-based): 34

            m_col = col_start
            for (
                index,
                answer,
                choice_response,
                is_choice_correct,
                str_response,
                is_str_correct,
            ) in self.record_id_results:
                # 가로로 한 칸씩 채움
                worksheet_main.write(row_idx_num, m_col, index, format_table)
                worksheet_main.write(row_idx_ans, m_col, answer, format_table)
                worksheet_main.write(row_idx_sel, m_col, choice_response, format_table)
                worksheet_main.write(
                    row_idx_ox,
                    m_col,
                    dsUtils.isCorrectToOX(is_choice_correct),
                    format_table,
                )
                m_col += 1

            # ----- 점수 집계(범위를 B~끝열의 O/X 행으로 제한) -----
            left = xl_col_to_name(col_start)  # 'B'
            right = xl_col_to_name(col_start + total_q - 1)  # 끝 열
            # 정답/오답 수
            worksheet_main.write(
                "M35", f'=COUNTIF({left}{ox_row_excel}:{right}{ox_row_excel},"O")'
            )
            worksheet_main.write(
                "M36", f'=COUNTIF({left}{ox_row_excel}:{right}{ox_row_excel},"X")'
            )

            # 점수 숫자(L30) = 정답 수(M35), 분모(M30) = /total_q  (고정 "/12" 제거)
            worksheet_main.write("L30", "=M35", format_score_base)
            worksheet_main.write("M30", f"/{total_q}", format_score_base)

            # 파이 차트
            chart_id = workbook.add_chart({"type": "pie"})
            chart_id.add_series(
                {
                    "name": dsText.resultText["result_test_identification_title"],
                    "categories": "=DigitalOlfactoryTestReport!$L$35:$L$36",
                    "values": "=DigitalOlfactoryTestReport!$M$35:$M$36",
                    "data_labels": {"value": True, "percentage": True},
                }
            )
            chart_id.set_title(
                {"name": dsText.resultText["result_test_identification_title"]}
            )
            chart_id.set_style(10)
            worksheet_main.insert_chart("B13", chart_id, {"x_offset": 0, "y_offset": 0})

            # 총점 영역(J4:K5)에 정답 수 표시 (그래프와 동일) - 유지
            worksheet_main.merge_range("J4:K5", "=M35", format_small_table_title)

        # 닫기
        workbook.close()